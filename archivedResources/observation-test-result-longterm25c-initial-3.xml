<?xml version="1.0" encoding="UTF-8"?>
<Observation xmlns="http://hl7.org/fhir">
    <id value="observation-test-result-dxpq-ex1"/>
    <meta>
        <profile value="http://hl7.org/fhir/uv/pharm-quality/StructureDefinition/Observation-test-result-dxpq"/>
    </meta>
<!--    <instantiatesReference>
        <reference value="ObservationDefinition/Impurities"/>
    </instantiatesReference>-->
    <status value="final"/>
    <code>
        <coding>
<!--            <system value="http://loinc.org"/>-->
                                <system value="http://dummy.loinc.org"/>
            <code value="DGP"/>
                                <display value="Degradation Products"/>
        </coding>
                            <text value="Degradation Products"/>
    </code>
                        <subject>
                            <reference value="Medication/medication-batch-information-dxpq-ex1"/>
                        </subject>
				<effectiveDateTime value="2023-01-01T12:00:00Z"/>
				<performer>
				    <reference value="Organization/organization-dxpq-ex1"/>
				</performer>
    <valueQuantity>
                            <value value="0.101"/>
                            <unit value="% w/w"/>
                            <system value="http://unitsofmeasure.org"/>
                            <code value="%"/>
    </valueQuantity>
    <component>
        <code>
            <coding>
<!--                <system value="http://loinc.org"/>-->
                                    <system value="http://dummy.loinc.org"/>
                <code value="IMP"/>
                <display value="Impurity"/>
            </coding>
        </code>
        <valueCodeableConcept>
            <text value="Impurity 1"/>
        </valueCodeableConcept>
    </component>
</Observation>

<entry>
    <fullUrl value="urn:uuid:8bf75da1-9221-66fe-6725-c64cb45a57e6"/>
    <resource>
        <Observation>
            <!--LongTerm25C-initial-3-->
            <id value="8bf75da1-9221-66fe-6725-c64cb45a57e6"/>
            <!-- TODO This doesnt match the specimen -->
            <contained>
                <Observation>
                    <id value="LongTerm25C-initial-3-Description"/>
                    <instantiatesReference>
                        <!--ObservationDefinition/Description-->
                        <reference value="ObservationDefinition/1178fc31-0cfd-8c60-0b5b-9ae2850c6774"/>
                    </instantiatesReference>
                    <status value="final"/>
                    <code>
                        <coding>
                            <system value="http://dummy.loinc.org"/>
                            <code value="XXX"/>
                            <display value="Description"/>
                        </coding>
                        <text value="Description"/>
                    </code>
                    <subject>
                        <!--Medication/medication-actual-batch-3-->
                        <reference value="Medication/f54d4666-7ae3-4e30-8c5a-6d13838c4f3b"/>
                    </subject>
                    <effectiveDateTime value="2023-01-01T12:00:00Z"/>
                    <performer>
                        <!--Organization/tester-->
                        <reference value="Organization/e3d2bc19-2f10-2b4d-1741-e4135fe612a9"/>
                    </performer>
                    <valueCodeableConcept>
                        <text value="Complies"/>
                    </valueCodeableConcept>
                </Observation>
            </contained>
            <contained>
                <Observation>
                    <id value="LongTerm25C-initial-3-Degradation"/>
                    <instantiatesReference>
                        <!--ObservationDefinition/Degradation-->
                        <reference value="ObservationDefinition/2c5683d6-6e94-825b-056a-129a04c95e2f"/>
                    </instantiatesReference>
                    <status value="final"/>
                    <code>
                        <coding>
                            <system value="http://dummy.loinc.org"/>
                            <code value="DGP"/>
                            <display value="Degradation Products"/>
                        </coding>
                        <text value="Degradation Products"/>
                    </code>
                    <subject>
                        <!--Medication/medication-actual-batch-3-->
                        <reference value="Medication/f54d4666-7ae3-4e30-8c5a-6d13838c4f3b"/>
                    </subject>
                    <effectiveDateTime value="2023-01-01T12:00:00Z"/>
                    <performer>
                        <!--Organization/tester-->
                        <reference value="Organization/e3d2bc19-2f10-2b4d-1741-e4135fe612a9"/>
                    </performer>
                    <valueQuantity>
                        <value value="0.1"/>
                        <unit value="% w/w"/>
                        <system value="http://unitsofmeasure.org"/>
                        <code value="%"/>
                    </valueQuantity>
                </Observation>
            </contained>
            <contained>
                <Observation>
                    <id value="LongTerm25C-initial-3-Microbiological"/>
                    <instantiatesReference>
                        <!--ObservationDefinition/Microbiological-->
                        <reference value="ObservationDefinition/73d9d304-a0b8-31b6-1165-346563b9305e"/>
                    </instantiatesReference>
                    <status value="final"/>
                    <code>
                        <coding>
                            <system value="http://dummy.loinc.org"/>
                            <code value="YYY"/>
                            <display value="Microbiological Quality"/>
                        </coding>
                    </code>
                    <subject>
                        <!--Medication/medication-actual-batch-3-->
                        <reference value="Medication/f54d4666-7ae3-4e30-8c5a-6d13838c4f3b"/>
                    </subject>
                    <effectiveDateTime value="2023-01-01T12:00:00Z"/>
                    <performer>
                        <!--Organization/tester-->
                        <reference value="Organization/e3d2bc19-2f10-2b4d-1741-e4135fe612a9"/>
                    </performer>
                    <valueCodeableConcept>
                        <text value="Complies"/>
                    </valueCodeableConcept>
                </Observation>
            </contained>
            <contained>
                <Observation>
                    <id value="LongTerm25C-initial-3-Uniformity"/>
                    <instantiatesReference>
                        <!--ObservationDefinition/Uniformity-->
                        <reference value="ObservationDefinition/ef781c18-8e86-7859-209b-469ee9ad42d8"/>
                    </instantiatesReference>
                    <status value="final"/>
                    <code>
                        <coding>
                            <system value="http://dummy.loinc.org"/>
                            <code value="ZZZ"/>
                            <display value="Uniformity of dosage units (by weight)"/>
                        </coding>
                    </code>
                    <subject>
                        <!--Medication/medication-actual-batch-3-->
                        <reference value="Medication/f54d4666-7ae3-4e30-8c5a-6d13838c4f3b"/>
                    </subject>
                    <effectiveDateTime value="2023-01-01T12:00:00Z"/>
                    <performer>
                        <!--Organization/tester-->
                        <reference value="Organization/e3d2bc19-2f10-2b4d-1741-e4135fe612a9"/>
                    </performer>
                    <valueCodeableConcept>
                        <text value="Complies"/>
                    </valueCodeableConcept>
                </Observation>
            </contained>
            <!-- use a standard extension to say what plan this is being done for. However it doesn't link to the step of that plan
                     that would mean using sub-ActivityDefintions probably -->
            <extension url="http://hl7.org/fhir/StructureDefinition/workflow-triggeredBy">
                <valueReference>
                    <!--ActivityDefinition/activityLongTerm25XYZ-Initial-->
                    <reference value="ActivityDefinition/4bfe1ee8-91ed-5c1b-3045-c749bb9d1d90"/>
                </valueReference>
            </extension>
            <status value="final"/>
            <code>
                <text value="Test Components - Long-term 25C etc - Initial (XYZ)"/>
            </code>
            <subject>
                <!--Medication/medication-actual-batch-3-->
                <reference value="Medication/f54d4666-7ae3-4e30-8c5a-6d13838c4f3b"/>
            </subject>
            <effectiveDateTime value="2023-01-01T12:00:00Z"/>
            <performer>
                <!--Organization/tester-->
                <reference value="Organization/e3d2bc19-2f10-2b4d-1741-e4135fe612a9"/>
            </performer>
            <specimen>
                <!--Specimen/stabilityInitial-3-->
                <reference value="Specimen/b664977d-799d-a1ce-928b-5def2a9955be"/>
            </specimen>
            <hasMember>
                <reference value="#LongTerm25C-initial-3-Description"/>
            </hasMember>
            <hasMember>
                <reference value="#LongTerm25C-initial-3-Degradation"/>
            </hasMember>
            <hasMember>
                <reference value="#LongTerm25C-initial-3-Microbiological"/>
            </hasMember>
            <hasMember>
                <reference value="#LongTerm25C-initial-3-Uniformity"/>
            </hasMember>
        </Observation>
    </resource>
</entry>